
<div class="row">
  <nb-card class="col-md-3">
    <nb-card-body>
      <div class="stat">{{ stats.statisticCard?.projects }}</div>
    </nb-card-body>
    <nb-card-footer>
      <div class="desc">Projects</div>
    </nb-card-footer>
  </nb-card>

  <nb-card class="col-md-3">
    <nb-card-body>
      <div class="stat">{{ stats.statisticCard?.scanRunning }}</div>
    </nb-card-body>
    <nb-card-footer>
      <div class="desc">Running scans</div>
    </nb-card-footer>
  </nb-card>

  <nb-card class="col-md-3">
    <nb-card-body>
      <div class="stat">{{ stats.statisticCard?.scanInQueue }}</div>
    </nb-card-body>
    <nb-card-footer>
      <div class="desc">Scans in queue</div>
    </nb-card-footer>
  </nb-card>

  <nb-card class="col-md-3">
    <nb-card-body>
      <div class="stat">{{ stats.statisticCard?.vulnerabilities }}</div>
    </nb-card-body>
    <nb-card-footer>
      <div class="desc">Vulnerabilities</div>
    </nb-card-footer>
  </nb-card>
</div>

<div class="row">
  <div class="col-md-12">
    <nb-card >
      <nb-tabset (changeTab)="changeTab($event)">

        <nb-tab tabTitle="Projects" tabIcon="browser-outline">
          <ngx-project-table></ngx-project-table>
        </nb-tab>
        <nb-tab tabTitle="Statistics" tabIcon="pie-chart-outline" >
          <ngx-dashboard-vuln-trend-analytics *ngIf="activeTab === 'Statistics' && trendResponse?.length > 0" [trendResponse]="trendResponse" [sourceData]="chartData" [trendType]="'Linear'" [pieTitle]="'Vulnerability source'"></ngx-dashboard-vuln-trend-analytics>
          <div class="row" *ngIf="activeTab === 'Statistics'">
            <div class="col-md-6">
              <nb-card>
                <nb-card-header>
                  Top 10 projects with Highest Risk score
                </nb-card-header>
                <nb-card-body>
                  <div echarts
                       [options]="projectOptions"
                       class="echart">
                  </div>
                </nb-card-body>
              </nb-card>
            </div>
            <div class="col-md-6">
              <nb-card>
                <nb-card-header>
                  Top 10 most common Critical Vulnerabilities
                </nb-card-header>
                <nb-card-body>
                  <div echarts
                       [options]="vulnOptions"
                       class="echart">
                  </div>
                </nb-card-body>
              </nb-card>
            </div>
          </div>
        </nb-tab>
        <nb-tab tabTitle="Metrics" tabIcon="activity-outline">
          <div class="metrics-container">
            <ngx-metric class="metric-card col-md-4" title="Number of active vulnerabilities" image="success1.png" [accent]="vulnNumberColor" [topLine]="metric?.activeVulnNo+''" [bottomLine]="'Average: '+ metric?.activeVulnAvg+' vulnerabilities per project'"></ngx-metric>
            <ngx-metric class="metric-card col-md-4" title="Number of Fixed vulnerabilities" image="001-no-passing.png" [accent]="fixedVulnColor" [topLine]="metric?.fixedVulnNo+''" [bottomLine]="'Which is ' + metric?.fixedVulnPercent + '% of all vulnerabilities'"></ngx-metric>
            <ngx-metric class="metric-card col-md-4" title="Average fix time [days]" image="success_time.png" [accent]="ttmColor" [topLine]="metric?.fixTime+''" [bottomLine]="'Which is ' + (metric?.fixTime < 10 ? 'Great! keep going!' : 'not so good, focus on fixing the vulnerabilities') "></ngx-metric>
            <ngx-metric class="metric-card col-md-4" title="Number of CICD jobs that verify security" image="success3.png" [accent]="cicdColor" [topLine]="metric?.projectWithCicdNo+''" [bottomLine]="'Which is ' + metric?.projectWithCicdPercent + '% of all projects'"></ngx-metric>
            <ngx-metric class="metric-card col-md-4" title="Number of CICD jobs that are secure" image="005-flammable.png" [accent]="secureCicd" [topLine]="metric?.secureJobNo+''" [bottomLine]="'Which is ' + metric?.secureJobPercent + '% of all jobs'"></ngx-metric>
            <ngx-metric class="metric-card col-md-4" title="Number of projects with Bug Tracking integrated" image="nuclear_hires.png" [accent]="btcolor" [topLine]="metric?.bugTrackingIntegratedNo+''" [bottomLine]="'Which covers ' + metric?.bugTrackingIntegratedPercent + '% of all projects'"></ngx-metric>
          </div>
        </nb-tab>

      </nb-tabset>
    </nb-card>
  </div>
</div>
